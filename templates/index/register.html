{%extends 'index/base.html'%}
{%block title%}Register{%endblock title%}
{%block content%}
<div class="container">
	<div class="row">
		<div class="col-md-6 col-12 bg-danger text-white">
			<form class="needs-validation" method="POST" action="{%url 'register'%}">
				{% csrf_token %}
				<h2>Register</h2>
				<div class="row">
					<div class="col-6 col-md-6">
						<label for="firstname">Firstname</label>
						<input type="text" class="form-control" name="firstname" required="">
					</div>
					<div class="col-6 col-md-6">
						<label for="secondname">Lastname</label>
						<input type="text" class="form-control" name="secondname" required="">
					</div>
				</div>
				<div class="row">
					<div class="col-6 col-md-6">
						<label for="username">Username</label>
						<input type="text" class="form-control" id="username" name="username" required="">
					</div>
					<div class="col-6 col-md-6">
						<label for="idno">Identity No</label>
						<input type="number" class="form-control" name="idno" required="">
					</div>
				</div>
				<div class="row">
					<div class="col-6 col-md-6">
						<label for="email">Email</label>
						<input type="email" class="form-control" name="email" required="">
					</div>
					<div class="col-6 col-md-6">
						<label for="contact">Phone Number</label>
						<input type="tel" class="form-control" name="contact" pattern="[+]{1}[0-9]{12}" required="">
					</div>
				</div>
				<div class="row">
					<div class="col-6 col-md-6">
						<label for="pass1">Password</label>
						<input type="password" class="form-control" name="pass1" id="pass1" required="">
					</div>
					<div class="col-6 col-md-6">
						<label for="pass2">Confirm Password</label>
						<input type="password" class="form-control" name="pass2" id="pass2" required="">
					</div>
				</div>
				<div class="row">
					<div class="col-6 col-md-6">
					<label for="category">Category</label>
					<select class="form-control" name="category" required="">
						<option class="form-control" value="Owner">Vehicle Owner</option>
						<option class="form-control" value="Client">Client</option>
					</select>
					</div>
					<div class="col-6 col-md-6">
						<label for="terms">Accept terms.</label>
						<input type="checkbox" class="form-control" name="terms" required="">
					</div>
					</div>
				<input type="submit" class=" form-control btn btn-success btn-block my-2" value="Submit">
				<p>Already have an account?<a  href="{%url 'enter'%}">Login</a></p>
			</form>
</div>
</div>
</div>
<script type="text/javascript">
	$("#username").change(function (e) {
      var username = $(this).val();

      $.ajax({
        url: '{%url 'validate'%}',
        data: {
          'username': username
        },
        dataType: 'json',
        success: function (data) {
          if (data.is_taken) {
          	alert('Username is taken please pick another!')
            document.getElementById("username").value='';
          }
        }
      });

    });
    $("#pass2").change(function(e){
		e.preventDefault();
		var password1= $("#pass1").val();
		var password2= $(this).val();
		if(password1 !== password2){
			alert("Error! passwords dont match")
			document.getElementById("pass1").value="";
			document.getElementById("pass2").value="";
		}
	});
</script>
{%endblock content%}